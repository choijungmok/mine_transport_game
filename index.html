<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>â›ï¸ ê´‘ì‚° ê²½ì˜ ì‹œë®¬ë ˆì´ì…˜ ê²Œì„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Common Styles */
        .dashboard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-small {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid #17a2b8;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }

        /* Start Screen */
        .start-screen {
            max-width: 600px;
            margin: 50px auto;
            display: block;
        }

        .start-screen h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 15px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .game-info {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ffc107;
            margin-top: 20px;
        }

        .game-info h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .game-info ul {
            list-style: none;
            padding: 0;
        }

        .game-info li {
            padding: 8px 0;
            color: #856404;
            line-height: 1.6;
        }

        /* Game Screen */
        .game-screen {
            display: none;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .dashboard-title h1 {
            color: #667eea;
            margin-bottom: 5px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-card.warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .stat-card.success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .stat-card.custom {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #333;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
        }

        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 30px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.85em;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn-nav {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-nav.active {
            background: #667eea;
            color: white;
        }

        .btn-nav:not(.active) {
            background: #e9ecef;
            color: #495057;
        }

        .btn-nav:hover {
            transform: translateY(-2px);
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .card h2 {
            color: #333;
            margin-bottom: 20px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .card h3 {
            color: #555;
            margin-bottom: 15px;
            margin-top: 20px;
        }

        .worker-list, .ship-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .worker-item, .ship-item {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }

        .worker-item h4, .ship-item h4 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .worker-info, .ship-info {
            font-size: 0.95em;
            color: #666;
            line-height: 1.8;
        }

        .worker-info p, .ship-info p {
            margin: 5px 0;
        }

        .worker-actions, .ship-actions {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Result Screen */
        .result-screen {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .result-screen h1 {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .result-screen.success h1 {
            color: #28a745;
        }

        .result-screen.failed h1 {
            color: #dc3545;
        }

        .result-stats {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin: 30px auto;
            text-align: left;
            max-width: 600px;
        }

        .result-stats h2 {
            text-align: center;
            margin-bottom: 25px;
            color: #333;
        }

        .result-stats p {
            font-size: 1.2em;
            margin: 15px 0;
            color: #555;
        }

        /* Animations */
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(400px); opacity: 0; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .dashboard {
                padding: 20px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .worker-list, .ship-list {
                grid-template-columns: 1fr;
            }

            .start-screen {
                margin: 20px auto;
                padding: 0 10px;
            }

            .start-screen h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ì‹œì‘ í™”ë©´ -->
        <div id="startScreen" class="start-screen">
            <div class="dashboard">
                <h1>â›ï¸ ê´‘ì‚° ê²½ì˜ ì‹œë®¬ë ˆì´ì…˜</h1>
                <p class="subtitle">ë‹¹ì‹ ì€ ê´‘ì‚°ì˜ ì£¼ì¸ì…ë‹ˆë‹¤. ë…¸ë™ìë¥¼ ê³ ìš©í•˜ê³  ë°°ë¥¼ ê´€ë¦¬í•˜ì—¬ ë¶€ë¥¼ ì¶•ì í•˜ì„¸ìš”!</p>
                
                <div class="form-group">
                    <label for="playerName">í”Œë ˆì´ì–´ ì´ë¦„</label>
                    <input type="text" id="playerName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="20">
                </div>
                
                <div class="form-group">
                    <label for="targetGold">ëª©í‘œ ê¸ˆì•¡ (ê³¨ë“œ)</label>
                    <input type="number" id="targetGold" value="10000000" min="1000000" step="1000000">
                </div>
                
                <button class="btn btn-primary" onclick="startGame()">ìƒˆ ê²Œì„ ì‹œì‘</button>
                
                <div class="game-info">
                    <h3>ê²Œì„ ê·œì¹™</h3>
                    <ul>
                        <li>ğŸ’° <strong>ì„±ê³µ ì¡°ê±´:</strong> ëª©í‘œ ê¸ˆì•¡ì„ ë‹¬ì„±í•˜ë©´ ìŠ¹ë¦¬!</li>
                        <li>ğŸ’¸ <strong>ì‹¤íŒ¨ ì¡°ê±´:</strong> ìš´ì˜ë¹„ê°€ 0 ì´í•˜ê°€ ë˜ë©´ íŒŒì‚°!</li>
                        <li>â›ï¸ ë…¸ë™ì ë ˆë²¨ì´ ë†’ì„ìˆ˜ë¡ ë” ë§ì´ ì±„êµ´í•˜ì§€ë§Œ ìœ ì§€ë¹„ë„ ì¦ê°€</li>
                        <li>ğŸš¢ ë°°ì˜ ì¢…ë¥˜ì™€ ì„ ì¥ì— ë”°ë¼ ìˆ˜ìµì´ í¬ê²Œ ë‹¬ë¼ì§</li>
                        <li>ğŸ“… ë§¤ì›” ì–´ìŒì´ ë„ì°©í•  ë•Œê¹Œì§€ ìê¸ˆì„ ê´€ë¦¬í•´ì•¼ í•¨</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- ê²Œì„ í™”ë©´ -->
        <div id="gameScreen" class="game-screen">
            <!-- ëŒ€ì‹œë³´ë“œ í—¤ë” -->
            <div class="dashboard">
                <div class="dashboard-header">
                    <div class="dashboard-title">
                        <h1>â›ï¸ <span id="displayPlayerName">í”Œë ˆì´ì–´</span>ì˜ ê´‘ì‚°</h1>
                        <p>í˜„ëª…í•œ ê²°ì •ìœ¼ë¡œ ë¶€ë¥¼ ì¶•ì í•˜ì„¸ìš”!</p>
                    </div>
                    <button class="btn btn-secondary" onclick="goToStart()">ğŸ  ì²˜ìŒìœ¼ë¡œ</button>
                </div>
                
                <!-- ì•Œë¦¼ ì˜ì—­ -->
                <div id="alertContainer"></div>
                
                <!-- í†µê³„ ì¹´ë“œ -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">ğŸ’° ë³´ìœ  ìê¸ˆ</div>
                        <div class="stat-value"><span id="currentGold">0</span> G</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-label">ğŸ¯ ëª©í‘œ ê¸ˆì•¡</div>
                        <div class="stat-value"><span id="targetGoldDisplay">0</span> G</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-label">ğŸ“… ê²½ê³¼ ì›”ìˆ˜</div>
                        <div class="stat-value"><span id="gameMonth">0</span> ê°œì›”</div>
                    </div>
                </div>
                
                <!-- ì§„í–‰ë¥  ë°” -->
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
                </div>
                
                <!-- ì¶”ê°€ í†µê³„ -->
                <div class="stats-grid">
                    <div class="stat-card custom">
                        <div class="stat-label">â›ï¸ ë³´ê´€ ì¤‘ì¸ ê´‘ë¬¼</div>
                        <div class="stat-value"><span id="oreStorage">0</span></div>
                    </div>
                    <div class="stat-card custom">
                        <div class="stat-label">ğŸ“ˆ ì¼ì¼ ì±„êµ´ëŸ‰</div>
                        <div class="stat-value"><span id="dailyMining">0</span></div>
                    </div>
                    <div class="stat-card custom">
                        <div class="stat-label">ğŸ’¸ ì›” ìœ ì§€ë¹„</div>
                        <div class="stat-value"><span id="monthlyMaintenance">0</span> G</div>
                    </div>
                </div>
                
                <!-- ì‹œê°„ ì§„í–‰ ë²„íŠ¼ -->
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 20px;">
                    <button class="btn btn-info" onclick="advanceTime(1)" style="flex: 1; min-width: 120px;">â© 1ì¼ ì§„í–‰</button>
                    <button class="btn btn-info" onclick="advanceTime(7)" style="flex: 1; min-width: 120px;">â© 7ì¼ ì§„í–‰</button>
                    <button class="btn btn-info" onclick="advanceTime(30)" style="flex: 1; min-width: 120px;">â© 30ì¼ ì§„í–‰</button>
                </div>
            </div>
            
            <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="dashboard">
                <div class="nav-buttons">
                    <button class="btn-nav active" onclick="showSection('mine')">â›ï¸ ê´‘ì‚° ê´€ë¦¬</button>
                    <button class="btn-nav" onclick="showSection('ship')">ğŸš¢ ì„ ë°• ê´€ë¦¬</button>
                </div>
            </div>
            
            <!-- ê´‘ì‚° ì„¹ì…˜ -->
            <div id="mineSection" class="section active">
                <div class="card">
                    <h2>â›ï¸ ê´‘ì‚° ê´€ë¦¬</h2>
                    
                    <div class="alert alert-info">
                        <strong>ğŸ’¡ íŒ:</strong> ë…¸ë™ì ë ˆë²¨ì´ ë†’ì„ìˆ˜ë¡ ì±„êµ´ëŸ‰ì´ ë§ì§€ë§Œ ìœ ì§€ë¹„ë„ ì¦ê°€í•©ë‹ˆë‹¤. ìˆ˜ìµê³¼ ë¹„ìš©ì˜ ê· í˜•ì„ ë§ì¶”ì„¸ìš”!
                    </div>
                    
                    <h3>ê³ ìš©ëœ ë…¸ë™ì</h3>
                    <div id="workerList" class="worker-list">
                        <p class="alert alert-info">ë…¸ë™ìë¥¼ ê³ ìš©í•˜ì„¸ìš”!</p>
                    </div>
                    
                    <button class="btn btn-primary" onclick="showHireWorkerModal()">ğŸ‘· ìƒˆ ë…¸ë™ì ê³ ìš©</button>
                </div>
            </div>
            
            <!-- ì„ ë°• ì„¹ì…˜ -->
            <div id="shipSection" class="section">
                <div class="card">
                    <h2>ğŸš¢ ì„ ë°• ê´€ë¦¬</h2>
                    
                    <div class="alert alert-info">
                        <strong>ğŸ’¡ íŒ:</strong> ì„ ë°•ì˜ ìˆ˜ìˆ˜ë£Œì™€ ì„ ì¥ì˜ ëŠ¥ë ¥ì— ë”°ë¼ ìµœì¢… ìˆ˜ìµì´ í¬ê²Œ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì‹ ì¤‘í•˜ê²Œ ì„ íƒí•˜ì„¸ìš”!
                    </div>
                    
                    <h3>ë³´ìœ  ì„ ë°•</h3>
                    <div id="shipList" class="ship-list">
                        <p class="alert alert-info">ì„ ë°•ì„ êµ¬ë§¤í•˜ì„¸ìš”!</p>
                    </div>
                    
                    <button class="btn btn-primary" onclick="showBuyShipModal()">ğŸ›’ ìƒˆ ì„ ë°• êµ¬ë§¤</button>
                </div>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div id="resultScreen" class="result-screen">
            <div class="dashboard">
                <div id="resultContent"></div>
            </div>
        </div>
    </div>

    <script>
        // ========== ê²Œì„ ìƒìˆ˜ ==========
        const GAME_CONFIG = {
            INITIAL_GOLD: 500000,
            INITIAL_ORE: 0,
            INITIAL_MINE_LEVEL: 1,
            DEFAULT_TARGET: 10000000,
            DAYS_PER_MONTH: 30,
            
            WORKER_TYPES: [
                { level: 1, name: 'ê²¬ìŠµìƒ', mining_rate: 10, cost: 5000 },
                { level: 2, name: 'ìˆ™ë ¨ê³µ', mining_rate: 25, cost: 15000 },
                { level: 3, name: 'ì „ë¬¸ê°€', mining_rate: 50, cost: 35000 },
                { level: 4, name: 'ë§ˆìŠ¤í„°', mining_rate: 100, cost: 75000 },
                { level: 5, name: 'ë ˆì „ë“œ', mining_rate: 200, cost: 150000 }
            ],
            
            SHIP_TYPES: [
                { type: 'ì†Œí˜• ìƒì„ ', capacity: 1000, speed_days: 60, commission: 5 },
                { type: 'ì¤‘í˜• ìƒì„ ', capacity: 3000, speed_days: 50, commission: 8 },
                { type: 'ëŒ€í˜• ìƒì„ ', capacity: 5000, speed_days: 45, commission: 10 },
                { type: 'êµ°í•¨', capacity: 2000, speed_days: 30, commission: 20 },
                { type: 'ê³ ì†ì„ ', capacity: 1500, speed_days: 25, commission: 15 }
            ],
            
            CAPTAIN_TYPES: [
                { name: 'ì„±ì‹¤í•œ ì¡´', morality: 9, luck: 7, loss_rate: 2 },
                { name: 'í–‰ìš´ì˜ ë©”ë¦¬', morality: 7, luck: 10, loss_rate: 3 },
                { name: 'í‰ë²”í•œ í†°', morality: 6, luck: 6, loss_rate: 8 },
                { name: 'ìš•ì‹¬ìŸì´ ì­', morality: 3, luck: 5, loss_rate: 15 },
                { name: 'ë² í…Œë‘ ìƒ˜', morality: 8, luck: 8, loss_rate: 4 }
            ],
            
            ORE_BASE_PRICE: 100,
            PRICE_VARIANCE: 0.3
        };

        // ========== ê²Œì„ ìƒíƒœ í´ë˜ìŠ¤ ==========
        class GameState {
            constructor() {
                this.playerName = '';
                this.currentGold = GAME_CONFIG.INITIAL_GOLD;
                this.targetGold = GAME_CONFIG.DEFAULT_TARGET;
                this.mineLevel = GAME_CONFIG.INITIAL_MINE_LEVEL;
                this.oreStorage = GAME_CONFIG.INITIAL_ORE;
                this.gameMonth = 1;
                this.gameDay = 1;
                this.gameStatus = 'playing';
                this.workers = [];
                this.ships = [];
            }
            
            getMonthlyMaintenance() {
                return this.workers.reduce((sum, w) => sum + (w.maintenance_cost * w.count), 0);
            }
            
            getDailyMining() {
                return this.workers.reduce((sum, w) => sum + (w.mining_rate * w.count), 0);
            }
            
            advanceDay() {
                this.oreStorage += this.getDailyMining();
                this.gameDay++;
                
                if (this.gameDay % GAME_CONFIG.DAYS_PER_MONTH === 0) {
                    this.advanceMonth();
                }
                
                this.checkShipArrivals();
            }
            
            advanceMonth() {
                this.gameMonth++;
                const maintenance = this.getMonthlyMaintenance();
                this.currentGold -= maintenance;
                
                if (this.currentGold <= 0) {
                    this.gameStatus = 'failed';
                }
            }
            
            checkShipArrivals() {
                this.ships.forEach(ship => {
                    if (ship.status === 'sailing' && this.gameDay >= ship.arrival_date) {
                        this.processShipArrival(ship);
                    }
                });
            }
            
            processShipArrival(ship) {
                const lossRate = ship.loss_rate / 100;
                const actualOre = ship.ore_loaded * (1 - lossRate);
                const priceVariation = 1 + (Math.random() - 0.5) * 2 * GAME_CONFIG.PRICE_VARIANCE;
                const orePrice = GAME_CONFIG.ORE_BASE_PRICE * priceVariation;
                const grossRevenue = actualOre * orePrice;
                const commission = grossRevenue * (ship.commission_rate / 100);
                const netRevenue = grossRevenue - commission;
                
                this.currentGold += netRevenue;
                
                ship.status = 'docked';
                ship.ore_loaded = 0;
                ship.departure_date = 0;
                ship.arrival_date = 0;
                
                showNotification(`ğŸš¢ ${ship.ship_type} ë„ì°©! ìˆœìˆ˜ìµ: ${formatNumber(Math.floor(netRevenue))} ê³¨ë“œ`, 'success');
                
                // ìŠ¹ë¦¬ ì¡°ê±´ ì²´í¬
                if (this.currentGold >= this.targetGold) {
                    this.gameStatus = 'success';
                    console.log('ëª©í‘œ ë‹¬ì„±! ê²Œì„ ìŠ¹ë¦¬!');
                }
            }
            
            hireWorker(level) {
                const workerType = GAME_CONFIG.WORKER_TYPES.find(w => w.level === level);
                if (!workerType) return false;
                
                if (this.currentGold < workerType.cost) {
                    showNotification('ìê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'danger');
                    return false;
                }
                
                const existingWorker = this.workers.find(w => w.worker_level === level);
                if (existingWorker) {
                    existingWorker.count++;
                } else {
                    this.workers.push({
                        worker_level: level,
                        worker_name: workerType.name,
                        count: 1,
                        mining_rate: workerType.mining_rate,
                        maintenance_cost: workerType.cost
                    });
                }
                
                this.currentGold -= workerType.cost;
                showNotification(`${workerType.name} ê³ ìš© ì™„ë£Œ!`, 'success');
                return true;
            }
            
            fireWorker(level) {
                const worker = this.workers.find(w => w.worker_level === level);
                if (!worker) return false;
                
                if (worker.count > 1) {
                    worker.count--;
                } else {
                    this.workers = this.workers.filter(w => w.worker_level !== level);
                }
                
                const workerType = GAME_CONFIG.WORKER_TYPES.find(w => w.level === level);
                const severance = Math.floor(workerType.cost * 0.3);
                this.currentGold -= severance;
                
                showNotification(`ë…¸ë™ì í•´ê³ . ìœ„ë¡œê¸ˆ: ${formatNumber(severance)} ê³¨ë“œ`, 'info');
                return true;
            }
            
            buyShip(shipType, captainName) {
                const ship = GAME_CONFIG.SHIP_TYPES.find(s => s.type === shipType);
                const captain = GAME_CONFIG.CAPTAIN_TYPES.find(c => c.name === captainName);
                
                if (!ship || !captain) return false;
                
                const shipCost = ship.capacity * 100;
                
                if (this.currentGold < shipCost) {
                    showNotification('ìê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'danger');
                    return false;
                }
                
                this.currentGold -= shipCost;
                
                this.ships.push({
                    ship_type: ship.type,
                    capacity: ship.capacity,
                    speed_days: ship.speed_days,
                    commission_rate: ship.commission,
                    status: 'docked',
                    ore_loaded: 0,
                    captain_name: captain.name,
                    loss_rate: captain.loss_rate,
                    departure_date: 0,
                    arrival_date: 0
                });
                
                showNotification(`${ship.type} êµ¬ë§¤ ì™„ë£Œ! (ì„ ì¥: ${captain.name})`, 'success');
                return true;
            }
            
            loadAndSendShip(shipIndex, oreAmount) {
                const ship = this.ships[shipIndex];
                if (!ship) return false;
                
                if (ship.status !== 'docked') {
                    showNotification('ì´ë¯¸ í•­í•´ ì¤‘ì¸ ë°°ì…ë‹ˆë‹¤!', 'warning');
                    return false;
                }
                
                if (oreAmount > ship.capacity) {
                    showNotification('ì ì¬ëŸ‰ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤!', 'warning');
                    return false;
                }
                
                if (oreAmount > this.oreStorage) {
                    showNotification('ë³´ìœ í•œ ê´‘ë¬¼ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'warning');
                    return false;
                }
                
                ship.ore_loaded = oreAmount;
                this.oreStorage -= oreAmount;
                ship.status = 'sailing';
                ship.departure_date = this.gameDay;
                ship.arrival_date = this.gameDay + ship.speed_days;
                
                showNotification(`${ship.ship_type} ì¶œë°œ! ${ship.speed_days}ì¼ í›„ ë„ì°© ì˜ˆì •`, 'info');
                return true;
            }
        }

        // ========== ì „ì—­ ë³€ìˆ˜ ==========
        let gameState = null;

        // ========== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ==========
        function formatNumber(num) {
            return new Intl.NumberFormat('ko-KR').format(num);
        }

        function showNotification(message, type = 'info') {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            alertDiv.style.position = 'fixed';
            alertDiv.style.top = '20px';
            alertDiv.style.right = '20px';
            alertDiv.style.zIndex = '9999';
            alertDiv.style.minWidth = '300px';
            alertDiv.style.animation = 'slideIn 0.3s ease-out';
            
            document.body.appendChild(alertDiv);
            
            setTimeout(() => {
                alertDiv.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => alertDiv.remove(), 300);
            }, 3000);
        }

        // ========== ê²Œì„ ì œì–´ í•¨ìˆ˜ ==========
        function startGame() {
            const playerName = document.getElementById('playerName').value.trim();
            const targetGold = parseInt(document.getElementById('targetGold').value);
            
            console.log('ê²Œì„ ì‹œì‘:', playerName, targetGold);
            
            if (!playerName) {
                showNotification('í”Œë ˆì´ì–´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”!', 'warning');
                return;
            }
            
            if (targetGold < 1000000) {
                showNotification('ëª©í‘œ ê¸ˆì•¡ì€ ìµœì†Œ 1,000,000 ê³¨ë“œ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤!', 'warning');
                return;
            }
            
            gameState = new GameState();
            gameState.playerName = playerName;
            gameState.targetGold = targetGold;
            
            console.log('ê²Œì„ ìƒíƒœ ìƒì„± ì™„ë£Œ:', gameState);
            
            // í™”ë©´ ì „í™˜
            const startScreen = document.getElementById('startScreen');
            const gameScreen = document.getElementById('gameScreen');
            
            console.log('í™”ë©´ ì „í™˜ ì‹œì‘');
            console.log('startScreen:', startScreen);
            console.log('gameScreen:', gameScreen);
            
            startScreen.style.display = 'none';
            gameScreen.style.display = 'block';
            
            console.log('í™”ë©´ ì „í™˜ ì™„ë£Œ');
            
            updateUI();
            console.log('UI ì—…ë°ì´íŠ¸ ì™„ë£Œ');
        }

        function goToStart() {
            if (confirm('ê²Œì„ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                document.getElementById('startScreen').style.display = 'block';
                document.getElementById('gameScreen').style.display = 'none';
                document.getElementById('resultScreen').style.display = 'none';
                gameState = null;
            }
        }

        function advanceTime(days) {
            for (let i = 0; i < days; i++) {
                gameState.advanceDay();
                
                if (gameState.gameStatus !== 'playing') {
                    showResult();
                    return;
                }
            }
            
            updateUI();
            showNotification(`${days}ì¼ì´ ê²½ê³¼í–ˆìŠµë‹ˆë‹¤.`, 'info');
        }

        function showSection(sectionName) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active'));
            
            document.getElementById(sectionName + 'Section').classList.add('active');
            event.target.classList.add('active');
            
            updateUI();
        }

        function updateUI() {
            if (!gameState) return;
            
            document.getElementById('displayPlayerName').textContent = gameState.playerName;
            document.getElementById('currentGold').textContent = formatNumber(gameState.currentGold);
            document.getElementById('targetGoldDisplay').textContent = formatNumber(gameState.targetGold);
            document.getElementById('gameMonth').textContent = gameState.gameMonth;
            document.getElementById('oreStorage').textContent = formatNumber(gameState.oreStorage);
            document.getElementById('dailyMining').textContent = formatNumber(gameState.getDailyMining());
            document.getElementById('monthlyMaintenance').textContent = formatNumber(gameState.getMonthlyMaintenance());
            
            const progress = Math.min((gameState.currentGold / gameState.targetGold) * 100, 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = progress + '%';
            progressBar.textContent = progress.toFixed(1) + '%';
            
            const alertContainer = document.getElementById('alertContainer');
            alertContainer.innerHTML = '';
            
            // ê²Œì„ ì¢…ë£Œ ì¡°ê±´ ì²´í¬
            if (gameState.gameStatus === 'success') {
                showNotification('ğŸ‰ ëª©í‘œ ë‹¬ì„±! ì¶•í•˜í•©ë‹ˆë‹¤!', 'success');
                setTimeout(() => {
                    showResult();
                }, 1500);
                return;
            } else if (gameState.gameStatus === 'failed') {
                showNotification('ğŸ’¸ íŒŒì‚°! ê²Œì„ ì˜¤ë²„', 'danger');
                setTimeout(() => {
                    showResult();
                }, 1500);
                return;
            }
            
            if (gameState.currentGold < gameState.getMonthlyMaintenance()) {
                alertContainer.innerHTML = '<div class="alert alert-danger">âš ï¸ ê²½ê³ : ë‹¤ìŒ ë‹¬ ìœ ì§€ë¹„ë¥¼ ë‚¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤! íŒŒì‚° ìœ„ê¸°!</div>';
            } else if (gameState.currentGold < gameState.getMonthlyMaintenance() * 3) {
                alertContainer.innerHTML = '<div class="alert alert-warning">âš ï¸ ì£¼ì˜: ìê¸ˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ì„ ë°•ì„ ë³´ë‚´ ìˆ˜ìµì„ í™•ë³´í•˜ì„¸ìš”!</div>';
            }
            
            updateWorkerList();
            updateShipList();
        }

        function updateWorkerList() {
            const workerList = document.getElementById('workerList');
            if (gameState.workers.length === 0) {
                workerList.innerHTML = '<p class="alert alert-info">ê³ ìš©ëœ ë…¸ë™ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            workerList.innerHTML = '';
            gameState.workers.forEach(worker => {
                const div = document.createElement('div');
                div.className = 'worker-item';
                div.innerHTML = `
                    <h4>${worker.worker_name} (ë ˆë²¨ ${worker.worker_level})</h4>
                    <div class="worker-info">
                        <p>ğŸ‘· ê³ ìš© ì¸ì›: ${worker.count}ëª…</p>
                        <p>â›ï¸ ì¼ì¼ ì±„êµ´ëŸ‰: ${formatNumber(worker.mining_rate * worker.count)} ê´‘ë¬¼</p>
                        <p>ğŸ’° ì›” ìœ ì§€ë¹„: ${formatNumber(worker.maintenance_cost * worker.count)} ê³¨ë“œ</p>
                    </div>
                    <div class="worker-actions">
                        <button class="btn-small btn-success" onclick="hireWorkerUI(${worker.worker_level})">+1 ê³ ìš©</button>
                        <button class="btn-small btn-danger" onclick="fireWorkerUI(${worker.worker_level})">-1 í•´ê³ </button>
                    </div>
                `;
                workerList.appendChild(div);
            });
        }

        function updateShipList() {
            const shipList = document.getElementById('shipList');
            if (gameState.ships.length === 0) {
                shipList.innerHTML = '<p class="alert alert-info">ë³´ìœ í•œ ì„ ë°•ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            shipList.innerHTML = '';
            gameState.ships.forEach((ship, index) => {
                const div = document.createElement('div');
                div.className = 'ship-item';
                
                let statusHTML = '';
                if (ship.status === 'docked') {
                    statusHTML = `
                        <p style="color: green;">âš“ ì •ë°• ì¤‘</p>
                        <div class="form-group">
                            <label>ì ì¬ëŸ‰ (ìµœëŒ€: ${formatNumber(ship.capacity)})</label>
                            <input type="number" id="oreAmount${index}" min="0" max="${ship.capacity}" value="${Math.min(gameState.oreStorage, ship.capacity)}">
                        </div>
                        <button class="btn-small btn-info" onclick="sendShip(${index})">ğŸš¢ ì¶œí•­</button>
                    `;
                } else {
                    const daysLeft = ship.arrival_date - gameState.gameDay;
                    statusHTML = `
                        <p style="color: orange;">ğŸŒŠ í•­í•´ ì¤‘ (${daysLeft}ì¼ ë‚¨ìŒ)</p>
                        <p>ì ì¬ëŸ‰: ${formatNumber(ship.ore_loaded)} ê´‘ë¬¼</p>
                    `;
                }
                
                div.innerHTML = `
                    <h4>${ship.ship_type}</h4>
                    <div class="ship-info">
                        <p>ğŸ‘¨â€âœˆï¸ ì„ ì¥: ${ship.captain_name}</p>
                        <p>ğŸ“¦ ì ì¬ëŸ‰: ${formatNumber(ship.capacity)} ê´‘ë¬¼</p>
                        <p>â±ï¸ ì™•ë³µ: ${ship.speed_days}ì¼</p>
                        <p>ğŸ’µ ìˆ˜ìˆ˜ë£Œ: ${ship.commission_rate}%</p>
                        ${statusHTML}
                    </div>
                `;
                shipList.appendChild(div);
            });
        }

        function showHireWorkerModal() {
            const levels = GAME_CONFIG.WORKER_TYPES.map(w => 
                `${w.level}. ${w.name} - ì±„êµ´: ${w.mining_rate}/ì¼, ë¹„ìš©: ${formatNumber(w.cost)}G`
            ).join('\n');
            
            const choice = prompt(`ë…¸ë™ìë¥¼ ê³ ìš©í•˜ì„¸ìš”:\n\n${levels}\n\në ˆë²¨ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1-5):`);
            
            if (choice) {
                const level = parseInt(choice);
                if (level >= 1 && level <= 5) {
                    hireWorkerUI(level);
                }
            }
        }

        function hireWorkerUI(level) {
            if (gameState.hireWorker(level)) {
                updateUI();
            }
        }

        function fireWorkerUI(level) {
            if (gameState.fireWorker(level)) {
                updateUI();
            }
        }

        function showBuyShipModal() {
            const ships = GAME_CONFIG.SHIP_TYPES.map((s, i) => 
                `${i + 1}. ${s.type} - ìš©ëŸ‰: ${s.capacity}, ì†ë„: ${s.speed_days}ì¼, ìˆ˜ìˆ˜ë£Œ: ${s.commission}%, ê°€ê²©: ${formatNumber(s.capacity * 100)}G`
            ).join('\n');
            
            const shipChoice = prompt(`ì„ ë°•ì„ ì„ íƒí•˜ì„¸ìš”:\n\n${ships}\n\në²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1-5):`);
            if (!shipChoice) return;
            
            const shipIndex = parseInt(shipChoice) - 1;
            if (shipIndex < 0 || shipIndex >= GAME_CONFIG.SHIP_TYPES.length) return;
            
            const captains = GAME_CONFIG.CAPTAIN_TYPES.map((c, i) => 
                `${i + 1}. ${c.name} - ë„ë•: ${c.morality}, í–‰ìš´: ${c.luck}, ì†ì‹¤ë¥ : ${c.loss_rate}%`
            ).join('\n');
            
            const captainChoice = prompt(`ì„ ì¥ì„ ì„ íƒí•˜ì„¸ìš”:\n\n${captains}\n\në²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (1-5):`);
            if (!captainChoice) return;
            
            const captainIndex = parseInt(captainChoice) - 1;
            if (captainIndex < 0 || captainIndex >= GAME_CONFIG.CAPTAIN_TYPES.length) return;
            
            const ship = GAME_CONFIG.SHIP_TYPES[shipIndex];
            const captain = GAME_CONFIG.CAPTAIN_TYPES[captainIndex];
            
            if (gameState.buyShip(ship.type, captain.name)) {
                updateUI();
            }
        }

        function sendShip(shipIndex) {
            const oreAmount = parseInt(document.getElementById(`oreAmount${shipIndex}`).value);
            
            if (isNaN(oreAmount) || oreAmount <= 0) {
                showNotification('ìœ íš¨í•œ ì ì¬ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”!', 'warning');
                return;
            }
            
            if (gameState.loadAndSendShip(shipIndex, oreAmount)) {
                updateUI();
            }
        }

        function showResult() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').style.display = 'block';
            
            const resultContent = document.getElementById('resultContent');
            const progressPercent = ((gameState.currentGold / gameState.targetGold) * 100).toFixed(1);
            
            if (gameState.gameStatus === 'success') {
                document.getElementById('resultScreen').className = 'result-screen success';
                resultContent.innerHTML = `
                    <h1>ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤!</h1>
                    <h2>ëª©í‘œ ê¸ˆì•¡ ë‹¬ì„± ì„±ê³µ!</h2>
                    
                    <div class="result-stats">
                        <h2>ğŸ“Š ìµœì¢… í†µê³„</h2>
                        <p><strong>í”Œë ˆì´ì–´:</strong> ${gameState.playerName}</p>
                        <p><strong>ìµœì¢… ìê¸ˆ:</strong> ${formatNumber(gameState.currentGold)} ê³¨ë“œ</p>
                        <p><strong>ëª©í‘œ ê¸ˆì•¡:</strong> ${formatNumber(gameState.targetGold)} ê³¨ë“œ</p>
                        <p><strong>ë‹¬ì„±ë¥ :</strong> ${progressPercent}%</p>
                        <p><strong>ê²½ê³¼ ì›”ìˆ˜:</strong> ${gameState.gameMonth}ê°œì›”</p>
                    </div>
                    
                    <div class="alert alert-success">
                        <strong>ğŸ† ìŠ¹ë¦¬!</strong><br>
                        ë‹¹ì‹ ì€ í›Œë¥­í•œ ê´‘ì‚° ê²½ì˜ìì…ë‹ˆë‹¤! ${gameState.gameMonth}ê°œì›” ë§Œì— ëª©í‘œë¥¼ ë‹¬ì„±í–ˆìŠµë‹ˆë‹¤.
                    </div>
                    
                    <button class="btn btn-primary" onclick="goToStart()">ğŸ”„ ë‹¤ì‹œ ë„ì „</button>
                `;
            } else {
                document.getElementById('resultScreen').className = 'result-screen failed';
                resultContent.innerHTML = `
                    <h1>ğŸ’” íŒŒì‚°!</h1>
                    <h2>ê²Œì„ ì˜¤ë²„</h2>
                    
                    <div class="result-stats">
                        <h2>ğŸ“Š ìµœì¢… í†µê³„</h2>
                        <p><strong>í”Œë ˆì´ì–´:</strong> ${gameState.playerName}</p>
                        <p><strong>ìµœì¢… ìê¸ˆ:</strong> ${formatNumber(gameState.currentGold)} ê³¨ë“œ</p>
                        <p><strong>ëª©í‘œ ê¸ˆì•¡:</strong> ${formatNumber(gameState.targetGold)} ê³¨ë“œ</p>
                        <p><strong>ë‹¬ì„±ë¥ :</strong> ${progressPercent}%</p>
                        <p><strong>ìƒì¡´ ì›”ìˆ˜:</strong> ${gameState.gameMonth}ê°œì›”</p>
                    </div>
                    
                    <div class="alert alert-danger">
                        <strong>ğŸ’¸ íŒŒì‚°!</strong><br>
                        ìš´ì˜ ìê¸ˆì´ ë°”ë‹¥ë‚¬ìŠµë‹ˆë‹¤. ìœ ì§€ë¹„ì™€ ìˆ˜ìµì˜ ê· í˜•ì„ ë” ì˜ ë§ì¶°ì•¼ í•©ë‹ˆë‹¤.
                    </div>
                    
                    <button class="btn btn-primary" onclick="goToStart()">ğŸ”„ ë‹¤ì‹œ ë„ì „</button>
                `;
            }
        }
    </script>
</body>
</html>
